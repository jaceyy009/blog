<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>{{ page.title | ROTA Vision Blog }}</title>
    <link rel="icon" type="image/x-icon" href="{{ '/favicon.ico' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  </head>
  <body>
    {% include header.html %}
    
    {{ content }}

    {% include footer.html %}

    <!-- Auto-update footer year -->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const yearEl = document.getElementById('year');
        if (yearEl) {
          yearEl.textContent = new Date().getFullYear();
        }
      });
    </script>
    
    <script>
      document.querySelectorAll('.alt-words').forEach(el => {
        // Split the heading text into words, wrap each in a <span>, and join back
        el.innerHTML = el.textContent
          .split(' ')
          .map(function(word { return '<span>' + word + '</span>'; })
          .join(' ');
      });
    </script>
    
    <script>
      const toggleTheme = () => {
        const current = document.documentElement.getAttribute('data-theme');
        const next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
      };

      //Load saved theme
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
      }
    </script>

    <body class="{{ page.body_class }}">

      <script>
        const pages = [
          { title: "Home", url: "/" },
          { title: "Contact", url: "/contact/" }
          ];

        const form = document.getElementById('searchForm');
        const input = document.getElementById('searchInput');
        const results = document.getElementById('searchResults');

        function runSearch(query) {
          results.innerHTML = '';

          if (!query) return;

            pages
            .filter(p => p.title.toLowerCase().includes(query))
            .forEach (p => {
              const link = docmuent.createElement('a');
              link.href = p.url;
              link.textContent = p.title;
              results.appendChild(link);
            });
        }
        
        if (input && results) {
          input.addEventListener('input', function () {
            const query = this.value.toLowerCase();
            runSearch(this.value.toLowerCase());
            ]);
        }

        if (form) {
          form.addEventListener('submit', function (e) {
            e.preventDefault(); // stop page reload
            runSearch(input.value.toLowerCase());
          });
        }
      </script>
  </body>
</html>
